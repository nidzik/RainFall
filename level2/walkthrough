see the exp.py..


(gdb) define hook-stop
Type commands for definition of "hook-stop".
End with a line saying just "end".
>x/1i $eip
>x/8wx $esp
>end

cant ret to the stack bc of cmp 0xb000000
so we ret to the end of the fct itself : 
$ gdb disass p 
 last intruction ret : 0x0804853e
 
then smash the next add(eip) with the stack add
$ b *0x0804853e 
$ info  register 
esp = 0xbffff740

there are no more checks here 

slide into nops (0xbffff740+30)  then put the shellcode
 
